---
title: "01_BLAST"
output: html_document
---

"This file is part of the process of me learning BLAST in the command pipeline! I am excited about it :)"

```{bash}
# make database 
sudo makeblastdb \
-in ../Data/uniprot_sprot_s2025_04.fasta \
-dbtype prot \
-out ../blastdb/uniprot_sprot_s2025_04
# explore file
head -3 ../Data/protein_two_spot.faa
echo "how many sequences are there?"
grep -c ">" ../Data/protein_two_spot.faa


```
```{R}
#read fasta
fasta_file <- "../Data/protein_two_spot.faa" 
sequences <- readDNAStringSet(fasta_file, format="fasta",
               nrec=-1L, skip=0L, seek.first.rec=FALSE,
               use.names=TRUE, with.qualities=FALSE)
sequence_lengths <- width(sequences)
sequence_lengths_df <- data.frame(Length = sequence_lengths)

# Plot histogram using ggplot2
ggplot(sequence_lengths_df, aes(x = Length)) +
  geom_histogram(binwidth = 3, color = "red", fill = "blue", alpha = 0.1) +
  labs(title = "Histogram of Sequence Lengths",
       x = "Sequence Length",
       y = "Frequency") +
  theme_minimal()
# Calculate base composition 
base_composition <- alphabetFrequency(sequences, baseOnly = TRUE)
#convert do data frame, reshape for ggplot2
base_composition_df <- as.data.frame(base_composition)
base_composition_df$ID <- rownames(base_composition_df)
```


```{R}
```


```{R}
```


```{R}
base_composition_melted <- reshape2::melt(base_composition_df, id.vars = "ID",variable.name = "Base", value.name = "Count")
# plot base compostion with a bar chart
ggplot(base_compistion_melted, aes(x = Base, y = Count, fill = Base))+
  geom_bar(stat = "identity", position = "dodge", color = "black")+
  labs(title = "Base Composition",
       x = "Base",
       y = "Count") +
  theme_minimal() +
  scale_fill_manual(values = c("A" = "green", "C"="blue", "G"="yellow", "T"= "red"))
```
  